
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta charset="utf-8"></meta>
      <meta name="viewport" content="width=device-width, initial-scale=1.0"></meta>
      <meta class="swiftype" name="neo4j-site" data-type="enum" content="Reference Docs"></meta>
      <meta class="swiftype" name="main-search-priority" data-type="integer" content="3"></meta>
      <title>6.3.&nbsp;Export to Cypher Script - Chapter&nbsp;6.&nbsp;Export</title>
      <link rel="stylesheet" type="text/css" href="../../docbook.css"></link>
      <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"></link>
      <link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.10.13/css/jquery.dataTables.min.css"></link>
      <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.1.0/css/font-awesome.min.css"></link>
      <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:400,300,400italic,600,300italic"></link>
      <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/codemirror.min.css"></link>
      <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/theme/neo.min.css"></link>
      <link rel="stylesheet" type="text/css" href="../../css/chunked-base.css"></link>
      <link rel="stylesheet" type="text/css" href="../../css/extra.css"></link><script src="//code.jquery.com/jquery-1.12.4.js" type="text/javascript"></script><script src="//cdn.datatables.net/1.10.13/js/jquery.dataTables.min.js" type="text/javascript"></script><script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" type="text/javascript"></script><script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/codemirror.min.js" type="text/javascript"></script><script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/addon/runmode/runmode.min.js" type="text/javascript"></script><script src="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/mode/cypher/cypher.min.js" type="text/javascript"></script><script src="../../javascript/datatable.js" type="text/javascript"></script><script src="../../javascript/colorize.js" type="text/javascript"></script><script src="../../javascript/tabs-for-chunked.js" type="text/javascript"></script><script src="../../javascript/mp-nav.js" type="text/javascript"></script><script src="../../javascript/versionswitcher.js" type="text/javascript"></script><script src="../../javascript/version.js" type="text/javascript"></script><script src="../../javascript/feedback.js" type="text/javascript"></script><script src="//s3-eu-west-1.amazonaws.com/alpha.neohq.net/docs/new-manual/assets/search.js" type="text/javascript"></script><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"></meta>
      <meta name="description" content="This section describes procedures that can be used to export data in Cypher format."></meta>
      <link rel="prev" href="../" title="Chapter&nbsp;6.&nbsp;Export"></link>
      <link rel="next" href="../csv/" title="6.1.&nbsp;Export to CSV"></link>
      <link rel="shortcut icon" href="https://neo4j.com/wp-content/themes/neo4jweb/favicon.ico"></link><script>var frontpage_relpath = "../../";
        $(document).ready(function() {
          CodeMirror.colorize();
          tabTheSource($('body'));
          var $header = $('header').first();
          $header.prepend(
            $('<a href="https://neo4j.com/docs/labs/" id="logo"><img src="https://s3.amazonaws.com/dev.assets.neo4j.com/wp-content/uploads/20190802073913/labs-logo6.png" alt="Neo4j Labs Logo"/></a>')
          );
          var sidebar = $('<div id="sidebar-wrapper"/>');
          $.get('toc.html', function (d){
            $(d).appendTo(sidebar);
            highlightToc();
            highlightLibraryHeader();
          });
          sidebar.insertAfter($('header').first());
          
        });

        </script></head>
   <body>
      <header>
         <div class="searchbox">
            <form id="search-form" class="search" name="search-form" role="search"><input id="search-form-input" name="q" title="search" type="search" lang="en" placeholder="Search Neo4j docs..." aria-label="Search Neo4j documentation" max-length="128" required="required"></input><input id="search-form-button" type="submit" value="Search"></input></form>
         </div>
         <ul class="documentation-library">
            <li><a href="https://neo4j.com/docs/labs/apoc/4.0/">APOC</a></li>
            <li><a href="https://neo4j.com/docs/labs/neo4j-streams/current/">Neo4j Streams</a></li>
            <li><a href="https://neo4j.com/docs/labs/nsmntx/current/">Neo Semantics</a></li>
            <li><a href="https://neo4j.com/docs/graph-algorithms/current/">Graph Algorithms</a></li>
            <li><a href="https://neo4j.com/docs/developer-manual/current/">Developer Manual</a></li>
         </ul>
         <nav id="header-nav"><span class="nav-previous"><a accesskey="p" href="../"><span class="fa fa-long-arrow-left" aria-hidden="true"></span>Export</a></span><span class="nav-current">
               <p class="nav-title hidden">6.3.&nbsp;Export to Cypher Script</p></span><span class="nav-next"><a accesskey="n" href="../csv/">Export to CSV<span class="fa fa-long-arrow-right" aria-hidden="true"></span></a></span></nav>
      </header>
      <div id="search-results" class="hidden"></div>
      <section class="section" id="export-cypher">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a class="anchor" href="#export-cypher"></a>6.3.&nbsp;Export to Cypher Script
                  </h2>
               </div>
            </div>
         </div>
         <div class="abstract">
            <p>This section describes procedures that can be used to export data in Cypher format.</p>
         </div>
         <p>The export to Cypher procedures export data as Cypher statements that can then be used to import the data into another Neo4j
            instance.
         </p>
         <div class="admonitionblock note">
            <table>
               <tbody>
                  <tr>
                     <td class="icon"><i class="fa icon-note" title="note"></i></td>
                     <td class="content">
                        <p>When exporting nodes, if a node label does not contain a unique constraint the exporter will add a <code class="literal">UNIQUE IMPORT LABEL</code> label and <code class="literal">UNIQUE IMPORT ID</code> property to those nodes to ensure uniqueness of nodes when the export script is executed on a new database.
                           The final step of the export script removes the <code class="literal">UNIQUE IMPORT LABEL</code> label and  <code class="literal">UNIQUE IMPORT ID</code>, so they won&#8217;t exist in the new database once the script has finished executing.
                        </p>
                        <p>If a node label does have a unique constraint, the property on which the unique constraint is defined will be used to ensure
                           uniqueness.
                        </p>
                     </td>
                  </tr>
               </tbody>
            </table>
         </div>
         <p>This section includes:</p>
         <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
               <li class="listitem"><a class="link" href="#export-cypher-available-procedures" title="6.3.1.&nbsp;Available Procedures">Available Procedures</a></li>
               <li class="listitem"><a class="link" href="#export-cypher-config" title="6.3.2.&nbsp;Configuration parameters">Configuration parameters</a></li>
               <li class="listitem"><a class="link" href="#export-cypher-file-export" title="6.3.3.&nbsp;Exporting to a file">Exporting to a file</a></li>
               <li class="listitem"><a class="link" href="#export-cypher-stream-export" title="6.3.4.&nbsp;Exporting a stream">Exporting a stream</a></li>
               <li class="listitem">
                  <p class="simpara"><a class="link" href="#export-cypher-examples" title="6.3.5.&nbsp;Examples">Examples</a></p>
                  <div class="itemizedlist">
                     <ul class="itemizedlist" style="list-style-type: circle; ">
                        <li class="listitem"><a class="link" href="#export-cypher-cypher-shell" title="6.3.5.1.&nbsp;Export to Cypher Shell format">Export to Cypher Shell format</a></li>
                        <li class="listitem"><a class="link" href="#export-cypher-neo4j-browser" title="6.3.5.2.&nbsp;Export to Neo4j Browser friendly format">Export to Neo4j Browser friendly format</a></li>
                        <li class="listitem"><a class="link" href="#export-cypher-multiple-files" title="6.3.5.4.&nbsp;Export to multiple files or columns">Export to multiple files or columns</a></li>
                        <li class="listitem"><a class="link" href="#export-cypher-different-cypher-format" title="6.3.5.3.&nbsp;Export using different Cypher update formats">Export using different Cypher update formats</a></li>
                        <li class="listitem"><a class="link" href="#export-cypher-examples-roundtrip" title="6.3.5.5.&nbsp;Round trip">Round trip</a></li>
                     </ul>
                  </div>
               </li>
            </ul>
         </div>
         <section class="section" id="export-cypher-available-procedures">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a class="anchor" href="#export-cypher-available-procedures"></a>6.3.1.&nbsp;Available Procedures
                     </h3>
                  </div>
               </div>
            </div>
            <p>The table below describes the available procedures:</p>
            <div class="informaltable">
               <div class="table" id="d0e14612">
                  <table class="informaltable" border="1">
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">type</th>
                           <th style="text-align: left; vertical-align: top; ">qualified name</th>
                           <th style="text-align: left; vertical-align: top; ">signature</th>
                           <th style="text-align: left; vertical-align: top; ">description</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>procedure</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.all</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.all(file =  :: STRING?, config = {} :: MAP?) :: (file :: STRING?, batches :: INTEGER?, source :: STRING?,
                                    format :: STRING?, nodes :: INTEGER?, relationships :: INTEGER?, properties :: INTEGER?, time :: INTEGER?, rows :: INTEGER?,
                                    batchSize :: INTEGER?, cypherStatements :: STRING?, nodeStatements :: STRING?, relationshipStatements :: STRING?, schemaStatements
                                    :: STRING?, cleanupStatements :: STRING?)</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>apoc.export.cypher.all(file,config) - exports whole database incl. indexes as cypher statements to the provided file</p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>procedure</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.data</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.data(nodes :: LIST? OF NODE?, rels :: LIST? OF RELATIONSHIP?, file =  :: STRING?, config = {} :: MAP?)
                                    :: (file :: STRING?, batches :: INTEGER?, source :: STRING?, format :: STRING?, nodes :: INTEGER?, relationships :: INTEGER?,
                                    properties :: INTEGER?, time :: INTEGER?, rows :: INTEGER?, batchSize :: INTEGER?, cypherStatements :: STRING?, nodeStatements
                                    :: STRING?, relationshipStatements :: STRING?, schemaStatements :: STRING?, cleanupStatements :: STRING?)</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>apoc.export.cypher.data(nodes,rels,file,config) - exports given nodes and relationships incl. indexes as cypher statements
                                 to the provided file
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>procedure</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.graph</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.graph(graph :: MAP?, file =  :: STRING?, config = {} :: MAP?) :: (file :: STRING?, batches :: INTEGER?,
                                    source :: STRING?, format :: STRING?, nodes :: INTEGER?, relationships :: INTEGER?, properties :: INTEGER?, time :: INTEGER?,
                                    rows :: INTEGER?, batchSize :: INTEGER?, cypherStatements :: STRING?, nodeStatements :: STRING?, relationshipStatements ::
                                    STRING?, schemaStatements :: STRING?, cleanupStatements :: STRING?)</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>apoc.export.cypher.graph(graph,file,config) - exports given graph object incl. indexes as cypher statements to the provided
                                 file
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>procedure</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.query</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.query(query :: STRING?, file =  :: STRING?, config = {} :: MAP?) :: (file :: STRING?, batches :: INTEGER?,
                                    source :: STRING?, format :: STRING?, nodes :: INTEGER?, relationships :: INTEGER?, properties :: INTEGER?, time :: INTEGER?,
                                    rows :: INTEGER?, batchSize :: INTEGER?, cypherStatements :: STRING?, nodeStatements :: STRING?, relationshipStatements ::
                                    STRING?, schemaStatements :: STRING?, cleanupStatements :: STRING?)</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>apoc.export.cypher.query(query,file,config) - exports nodes and relationships from the cypher statement incl. indexes as cypher
                                 statements to the provided file
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>procedure</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.schema</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p><code class="literal">apoc.export.cypher.schema(file =  :: STRING?, config = {} :: MAP?) :: (file :: STRING?, batches :: INTEGER?, source :: STRING?,
                                    format :: STRING?, nodes :: INTEGER?, relationships :: INTEGER?, properties :: INTEGER?, time :: INTEGER?, rows :: INTEGER?,
                                    batchSize :: INTEGER?, cypherStatements :: STRING?, nodeStatements :: STRING?, relationshipStatements :: STRING?, schemaStatements
                                    :: STRING?, cleanupStatements :: STRING?)</code></p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>apoc.export.cypher.schema(file,config) - exports all schema indexes and constraints to cypher</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <div class="admonitionblock note">
               <table>
                  <tbody>
                     <tr>
                        <td class="icon"><i class="fa icon-note" title="note"></i></td>
                        <td class="content">
                           <p>The labels exported are ordered alphabetically.
                              The output of <code class="literal">labels()</code> function is not sorted, use it in combination with <code class="literal">apoc.coll.sort()</code>.
                           </p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </section>
         <section class="section" id="export-cypher-config">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a class="anchor" href="#export-cypher-config"></a>6.3.2.&nbsp;Configuration parameters
                     </h3>
                  </div>
               </div>
            </div>
            <p>The procedures support the following config parameters:</p>
            <div class="table" id="d0e14718">
               <table class="table" summary="Config parameters" border="1">
                  <caption class="table-title">Table&nbsp;6.25.&nbsp;Config parameters</caption>
                  <colgroup>
                     <col class="col_1"></col>
                     <col class="col_2"></col>
                     <col class="col_3"></col>
                     <col class="col_4"></col>
                  </colgroup>
                  <thead>
                     <tr>
                        <th style="text-align: left; vertical-align: top; ">name</th>
                        <th style="text-align: left; vertical-align: top; ">type</th>
                        <th style="text-align: left; vertical-align: top; ">default</th>
                        <th style="text-align: left; vertical-align: top; ">description</th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>format</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>String</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>cypher-shell</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Export format. The following values are supported:</p>
                           
                           <div class="itemizedlist">
                              <ul style="list-style-type: disc; " class="itemizedlist">
                                 <li class="listitem"><code class="literal">cypher-shell</code> - for import with Cypher Shell
                                 </li>
                                 <li class="listitem"><code class="literal">neo4j-shell</code> - for import with Neo4j Shell and partly the <code class="literal">apoc.cypher.runFile</code> procedure
                                 </li>
                                 <li class="listitem"><code class="literal">plain</code> - exports plain Cypher without <code class="literal">begin</code>, <code class="literal">commit</code>, or <code class="literal">await</code> commands. For import with Neo4j Browser
                                 </li>
                              </ul>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>cypherFormat</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>String</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>create</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Cypher update operation type. The following values are supported:</p>
                           
                           <div class="itemizedlist">
                              <ul style="list-style-type: disc; " class="itemizedlist">
                                 <li class="listitem"><code class="literal">create</code> - only uses the <code class="literal">CREATE</code> clause
                                 </li>
                                 <li class="listitem"><code class="literal">updateAll</code> - uses <code class="literal">MERGE</code> instead of <code class="literal">CREATE</code></li>
                                 <li class="listitem"><code class="literal">addStructure</code> - uses <code class="literal">MATCH</code> for nodes and <code class="literal">MERGE</code> for relationships
                                 </li>
                                 <li class="listitem"><code class="literal">updateStructure</code> - uses <code class="literal">MERGE</code> and <code class="literal">MATCH</code> for nodes and relationships
                                 </li>
                              </ul>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>separateFiles</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>boolean</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>false</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Export to separate files? This is useful for later use with the <code class="literal">apoc.cypher.runFiles</code> and <code class="literal">apoc.cypher.runSchemaFiles</code> procedures.
                           </p>
                        </td>
                     </tr>
                     <tr>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>useOptimizations</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Map</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p><code class="literal">{type: "UNWIND_BATCH", unwindBatchSize: 20}</code></p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Optimizations to use for Cypher statement generation. <code class="literal">type</code> supports the following values:
                           </p>
                           
                           <div class="itemizedlist">
                              <ul style="list-style-type: disc; " class="itemizedlist">
                                 <li class="listitem"><code class="literal">NONE</code> - exports the file with <code class="literal">CREATE</code> statement
                                 </li>
                                 <li class="listitem"><code class="literal">UNWIND_BATCH</code> - exports the file by batching the entities with the <code class="literal">UNWIND</code> method as explained in Michael Hunger&#8217;s article on <a class="link" href="https://medium.com/neo4j/5-tips-tricks-for-fast-batched-updates-of-graph-structures-with-neo4j-and-cypher-73c7f693c8cc" target="_top">fast batched writes</a>.
                                 </li>
                                 <li class="listitem"><code class="literal">UNWIND_BATCH_PARAMS</code> - similar to <code class="literal">UNWIND_BATCH</code>, but also uses parameters where appropriate
                                 </li>
                              </ul>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>awaitForIndexes</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Long</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>300</p>
                        </td>
                        <td style="text-align: left; vertical-align: top; ">
                           <p>Timeout to use for <code class="literal">db.awaitIndexes</code> when using <code class="literal">format: "cypher-shell"</code></p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </section>
         <section class="section" id="export-cypher-file-export">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a class="anchor" href="#export-cypher-file-export"></a>6.3.3.&nbsp;Exporting to a file
                     </h3>
                  </div>
               </div>
            </div>
            <p>By default exporting to the file system is disabled.
               We can enable it by setting the following property in <code class="literal">apoc.conf</code>:
            </p>
            <p><span class="formalpara-title">apoc.conf.&nbsp;</span>
               
            </p><pre class="programlisting highlight"><code data-lang="properties">apoc.export.file.enabled=true</code></pre><p>
               
            </p>
            <p>If we try to use any of the export procedures without having first set this property, we&#8217;ll get the following error message:</p>
            <div class="informaltable">
               <div class="table" id="d0e14935">
                  <table class="informaltable" border="1">
                     <colgroup>
                        <col class="col_1"></col>
                     </colgroup>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>Failed to invoke procedure: Caused by: java.lang.RuntimeException: Export to files not enabled, please set apoc.export.file.enabled=true
                                 in your neo4j.conf
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <p>Export files are written to the <code class="literal">import</code> directory, which is defined by the <code class="literal">dbms.directories.import</code> property.
               This means that any file path that we provide is relative to this directory.
               If we try to write to an absolute path, such as <code class="literal">/tmp/filename</code>, we&#8217;ll get an error message similar to the following one:
            </p>
            <div class="informaltable">
               <div class="table" id="d0e14954">
                  <table class="informaltable" border="1">
                     <colgroup>
                        <col class="col_1"></col>
                     </colgroup>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>Failed to invoke procedure: Caused by: java.io.FileNotFoundException: /path/to/neo4j/import/tmp/fileName (No such file or
                                 directory)
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <p>We can enable writing to anywhere on the file system by setting the following property in <code class="literal">apoc.conf</code>:
            </p>
            <p><span class="formalpara-title">apoc.conf.&nbsp;</span>
               
            </p><pre class="programlisting highlight"><code data-lang="properties">apoc.import.file.use_neo4j_config=false</code></pre><p>
               
            </p>
            <div class="admonitionblock warning">
               <table>
                  <tbody>
                     <tr>
                        <td class="icon"><i class="fa icon-warning" title="warning"></i></td>
                        <td class="content">
                           <p>Neo4j will now be able to write anywhere on the file system, so be sure that this is your intention before setting this property.</p>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </section>
         <section class="section" id="export-cypher-stream-export">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a class="anchor" href="#export-cypher-stream-export"></a>6.3.4.&nbsp;Exporting a stream
                     </h3>
                  </div>
               </div>
            </div>
            <p>If we don&#8217;t want to export to a file, we can stream results back by providing a file name of <code class="literal">null</code>.
            </p>
            <p>By default all Cypher statements will be returned in a single row in the <code class="literal">cypherStatements</code> column.
            </p>
            <p><span class="formalpara-title">The following exports the whole database as a single row.&nbsp;</span>
               
            </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.all(null);</code></pre><p>
               
            </p>
            <p>If we&#8217;re exporting a large database, we can batch these statements across multiple rows by providing the <code class="literal">streamStatements:true</code> config and configuring the <code class="literal">batchSize</code> config.
            </p>
            <p><span class="formalpara-title">The following exports the whole database across multiple rows based on batch size.&nbsp;</span>
               
            </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.all(null, {
    streamStatements: true,
    batchSize: 100
});</code></pre><p>
               
            </p>
         </section>
         <section class="section" id="export-cypher-examples">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a class="anchor" href="#export-cypher-examples"></a>6.3.5.&nbsp;Examples
                     </h3>
                  </div>
               </div>
            </div>
            <p>This section includes examples showing how to use the export to Cypher procedures.
               These examples are based on a movies dataset, which can be imported by running the following Cypher query:
            </p><pre class="programlisting highlight"><code data-lang="cypher">CREATE (TheMatrix:Movie {title:'The Matrix', released:1999, tagline:'Welcome to the Real World'})
CREATE (Keanu:Person {name:'Keanu Reeves', born:1964})
CREATE (Carrie:Person {name:'Carrie-Anne Moss', born:1967})
CREATE (Laurence:Person {name:'Laurence Fishburne', born:1961})
CREATE (Hugo:Person {name:'Hugo Weaving', born:1960})
CREATE (LillyW:Person {name:'Lilly Wachowski', born:1967})
CREATE (LanaW:Person {name:'Lana Wachowski', born:1965})
CREATE (JoelS:Person {name:'Joel Silver', born:1952})
CREATE
(Keanu)-[:ACTED_IN {roles:['Neo']}]-&gt;(TheMatrix),
(Carrie)-[:ACTED_IN {roles:['Trinity']}]-&gt;(TheMatrix),
(Laurence)-[:ACTED_IN {roles:['Morpheus']}]-&gt;(TheMatrix),
(Hugo)-[:ACTED_IN {roles:['Agent Smith']}]-&gt;(TheMatrix),
(LillyW)-[:DIRECTED]-&gt;(TheMatrix),
(LanaW)-[:DIRECTED]-&gt;(TheMatrix),
(JoelS)-[:PRODUCED]-&gt;(TheMatrix);</code></pre><p>The Neo4j Browser visualization below shows the imported graph:</p>
            <div class="figure" id="d0e15024">
               <div class="figure-title">Figure&nbsp;6.1.&nbsp;Movies Graph Visualization</div>
               <div class="figure-contents">
                  <div class="mediaobject"><img src="../../images/play-movies.png" alt="play movies"></img></div>
               </div>
            </div>
            <section class="section" id="export-cypher-cypher-shell">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a class="anchor" href="#export-cypher-cypher-shell"></a>6.3.5.1.&nbsp;Export to Cypher Shell format
                        </h4>
                     </div>
                  </div>
               </div>
               <p>By default, the Cypher statements generated by the export to Cypher procedures are in the Cypher Shell format.</p>
               <p><span class="formalpara-title">The following query exports the whole database to <code class="literal">all.cypher</code> in the default <code class="literal">cypher-shell</code> format using the default <code class="literal">UNWIND_BATCH</code> optimization.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">// default config populated for illustration
CALL apoc.export.cypher.all("all.cypher", {
    format: "cypher-shell",
    useOptimizations: {type: "UNWIND_BATCH", unwindBatchSize: 20}
})
YIELD file, batches, source, format, nodes, relationships, properties, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, properties, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15055">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.26.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                        <col class="col_10"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"all.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"database: nodes(8), rels(7)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>8</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>7</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>21</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>10</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>15</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>The contents of <code class="literal">all.cypher</code>, with extra lines added for readability, are shown below:
               </p>
               <p><span class="formalpara-title">all.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">:begin
CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
:commit

:begin
UNWIND [{_id:0, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Movie;

UNWIND [{_id:1, properties:{born:1964, name:"Keanu Reeves"}}, {_id:2, properties:{born:1967, name:"Carrie-Anne Moss"}}, {_id:3, properties:{born:1961, name:"Laurence Fishburne"}}, {_id:4, properties:{born:1960, name:"Hugo Weaving"}}, {_id:5, properties:{born:1967, name:"Lilly Wachowski"}}, {_id:6, properties:{born:1965, name:"Lana Wachowski"}}, {_id:7, properties:{born:1952, name:"Joel Silver"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Person;
:commit

:begin
UNWIND [{start: {_id:1}, end: {_id:0}, properties:{roles:["Neo"]}}, {start: {_id:2}, end: {_id:0}, properties:{roles:["Trinity"]}}, {start: {_id:3}, end: {_id:0}, properties:{roles:["Morpheus"]}}, {start: {_id:4}, end: {_id:0}, properties:{roles:["Agent Smith"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ACTED_IN]-&gt;(end) SET r += row.properties;

UNWIND [{start: {_id:7}, end: {_id:0}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:PRODUCED]-&gt;(end) SET r += row.properties;

UNWIND [{start: {_id:5}, end: {_id:0}, properties:{}}, {start: {_id:6}, end: {_id:0}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:DIRECTED]-&gt;(end) SET r += row.properties;
:commit

:begin
MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
:commit

:begin
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
:commit</code></pre><p>
                  
               </p>
               <p>This Cypher script executes 5 transactions, each surrounded by <code class="literal">:begin</code> and <code class="literal">:commit</code> commands.
                  The transactions do the following:
               </p>
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">Create a unique constraint on the <code class="literal">UNIQUE IMPORT LABEL</code> label and <code class="literal">UNIQUE IMPORT ID</code> property
                     </li>
                     <li class="listitem">Import the <code class="literal">Person</code> and <code class="literal">Movie</code> nodes
                     </li>
                     <li class="listitem">Create <code class="literal">ACTED_IN</code>, <code class="literal">PRODUCED</code>, and <code class="literal">DIRECTED</code> relationships between these nodes
                     </li>
                     <li class="listitem">Remove the <code class="literal">UNIQUE IMPORT LABEL</code> label and <code class="literal">UNIQUE IMPORT ID</code> property from the nodes
                     </li>
                     <li class="listitem">Drop the unique constraint on the <code class="literal">UNIQUE IMPORT LABEL</code> label and <code class="literal">UNIQUE IMPORT ID</code> property
                     </li>
                  </ol>
               </div>
               <p>This script can be executed using the <a class="link" href="https://neo4j.com/docs/operations-manual/current/tools/cypher-shell/" target="_top">Cypher Shell</a> command line tool.
               </p>
               <p>For example, we could import the contents of <code class="literal">all.cypher</code> into a <a class="link" href="https://neo4j.com/aura" target="_top">Neo4j Aura</a> database by running the following command:
               </p><pre class="programlisting highlight"><code data-lang="bash">cat all.cypher | ./bin/cypher-shell -a &lt;bolt-url&gt; -u neo4j -p &lt;password&gt; --format verbose</code></pre><div class="admonitionblock note">
                  <table>
                     <tbody>
                        <tr>
                           <td class="icon"><i class="fa icon-note" title="note"></i></td>
                           <td class="content">
                              <p>Don&#8217;t forget to replace &lt;bolt-url&gt; and &lt;password&gt; with the appropriate credentials.</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>If we run this command against an empty database, we&#8217;ll see the following output:</p><pre class="programlisting highlight"><code data-lang="text">0 rows available after 70 ms, consumed after another 0 ms
Added 1 constraints
0 rows available after 16 ms, consumed after another 0 ms
Added 2 nodes, Set 8 properties, Added 4 labels
0 rows available after 40 ms, consumed after another 0 ms
Added 14 nodes, Set 42 properties, Added 28 labels
0 rows available after 51 ms, consumed after another 0 ms
Created 8 relationships, Set 8 properties
0 rows available after 38 ms, consumed after another 0 ms
Created 2 relationships
0 rows available after 38 ms, consumed after another 0 ms
Created 4 relationships
0 rows available after 20 ms, consumed after another 0 ms
Set 16 properties, Removed 16 labels
0 rows available after 3 ms, consumed after another 0 ms
Removed 1 constraints</code></pre><div class="admonitionblock note">
                  <table>
                     <tbody>
                        <tr>
                           <td class="icon" rowspan="2"><i class="fa icon-note" title="note"></i></td>
                           <th>Troubleshooting</th>
                        </tr>
                        <tr>
                           <td class="content">
                              <p>If you are experimenting with imports that are failing you can add the <code class="literal">--debug</code> command line parameter, to see which statement was executed last and caused the failure.
                              </p>
                              <p>Also check the memory configuration of your Neo4j instance, you might want to increase the HEAP size to <span class="strong"><strong>2&#8211;4GB</strong></span> using the <code class="literal">dbms.memory.heap.max_size=2G</code> setting in <code class="literal">neo4j.conf</code>.
                              </p>
                              <p>We can also provide more memory to cypher-shell itself by prefixing the command with: <code class="literal">JAVA_OPTS=-Xmx4G bin/cypher-shell &#8230;</code></p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>If we don&#8217;t have file system access, or don&#8217;t want to write to a file for another reason, we can stream back the export statements.</p>
               <p><span class="formalpara-title">The following query streams back the whole database in the <code class="literal">cypherStatements</code> column.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.all(null, {
    batchSize: 5,
    streamStatements: true,
    format: "cypher-shell",
    useOptimizations: {type: "UNWIND_BATCH", unwindBatchSize: 5}
})
YIELD nodes, relationships, properties, cypherStatements
RETURN nodes, relationships, properties, cypherStatements;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15251">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.27.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">cypherStatements</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>16</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>0</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>34</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                   CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.<code class="literal">UNIQUE IMPORT ID</code>) IS UNIQUE;
                                   :commit
                                   :begin
                                   UNWIND [{_id:0, properties:{tagline:\"Welcome to the Real World\", title:\"The Matrix\", released:1999}}, {_id:1, properties:{tagline:\"Welcome
                                 to the Real World\", title:\"The Matrix\", released:1999}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Movie;
                                   UNWIND [{_id:35, properties:{born:1967, name:\"Carrie-Anne Moss\"}}, {_id:36, properties:{born:1961, name:\"Laurence Fishburne\"}},
                                 {_id:37, properties:{born:1965, name:\"Lana Wachowski\"}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Person;
                                   :commit
                                   :begin
                                   UNWIND [{_id:38, properties:{born:1964, name:\"Keanu Reeves\"}}, {_id:39, properties:{born:1952, name:\"Joel Silver\"}},
                                 {_id:40, properties:{born:1960, name:\"Hugo Weaving\"}}, {_id:41, properties:{born:1967, name:\"Lilly Wachowski\"}}, {_id:42,
                                 properties:{born:1967, name:\"Carrie-Anne Moss\"}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Person;
                                   :commit
                                   :begin
                                   UNWIND [{_id:43, properties:{born:1965, name:\"Lana Wachowski\"}}, {_id:50, properties:{born:1960, name:\"Hugo Weaving\"}},
                                 {_id:51, properties:{born:1964, name:\"Keanu Reeves\"}}, {_id:57, properties:{born:1967, name:\"Lilly Wachowski\"}}, {_id:58,
                                 properties:{born:1961, name:\"Laurence Fishburne\"}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Person;
                                   :commit
                                   :begin
                                   UNWIND [{_id:59, properties:{born:1952, name:\"Joel Silver\"}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Person;
                                   :commit
                                   "
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>16</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>14</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>42</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                 UNWIND [{start: {_id:35}, end: {_id:0}, properties:{roles:[\"Trinity\"]}}, {start: {_id:36}, end: {_id:0}, properties:{roles:[\"Morpheus\"]}},
                                 {start: {_id:50}, end: {_id:1}, properties:{roles:[\"Agent Smith\"]}}, {start: {_id:40}, end: {_id:0}, properties:{roles:[\"Agent
                                 Smith\"]}}, {start: {_id:51}, end: {_id:1}, properties:{roles:[\"Neo\"]}}] AS row
                                 MATCH (start:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.start._id})
                                 MATCH (end:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.end._id})
                                 CREATE (start)-[r:ACTED_IN]&#8594;(end) SET r += row.properties;
                                 :commit
                                 :begin
                                 UNWIND [{start: {_id:42}, end: {_id:1}, properties:{roles:[\"Trinity\"]}}, {start: {_id:38}, end: {_id:0}, properties:{roles:[\"Neo\"]}},
                                 {start: {_id:58}, end: {_id:1}, properties:{roles:[\"Morpheus\"]}}] AS row
                                 MATCH (start:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.start._id})
                                 MATCH (end:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.end._id})
                                 CREATE (start)-[r:ACTED_IN]&#8594;(end) SET r += row.properties;
                                 UNWIND [{start: {_id:59}, end: {_id:1}, properties:{}}, {start: {_id:39}, end: {_id:0}, properties:{}}] AS row
                                 MATCH (start:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.start._id})
                                 MATCH (end:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.end._id})
                                 CREATE (start)-[r:PRODUCED]&#8594;(end) SET r += row.properties;
                                 :commit
                                 :begin
                                 UNWIND [{start: {_id:37}, end: {_id:0}, properties:{}}, {start: {_id:57}, end: {_id:0}, properties:{}}, {start: {_id:43},
                                 end: {_id:1}, properties:{}}, {start: {_id:41}, end: {_id:1}, properties:{}}] AS row
                                 MATCH (start:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.start._id})
                                 MATCH (end:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.end._id})
                                 CREATE (start)-[r:DIRECTED]&#8594;(end) SET r += row.properties;
                                 :commit
                                 "
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>16</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>14</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>42</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                 MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 5 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.<code class="literal">UNIQUE IMPORT ID</code>;
                                 :commit
                                 :begin
                                 MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 5 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.<code class="literal">UNIQUE IMPORT ID</code>;
                                 :commit
                                 :begin
                                 MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 5 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.<code class="literal">UNIQUE IMPORT ID</code>;
                                 :commit
                                 :begin
                                 MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 5 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.<code class="literal">UNIQUE IMPORT ID</code>;
                                 :commit
                                 :begin
                                 DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.<code class="literal">UNIQUE IMPORT ID</code>) IS UNIQUE;
                                 :commit
                                 "
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>We can then copy/paste the content of the <code class="literal">cypherStatements</code> column (excluding the double quotes) into a Cypher Shell session, or into a local file that we stream into a Cypher Shell
                  session.
               </p>
            </section>
            <section class="section" id="export-cypher-neo4j-browser">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a class="anchor" href="#export-cypher-neo4j-browser"></a>6.3.5.2.&nbsp;Export to Neo4j Browser friendly format
                        </h4>
                     </div>
                  </div>
               </div>
               <p>The export to Cypher procedures support the config <code class="literal">format: "plain"</code>, which is useful for later import using the <a class="link" href="https://neo4j.com/developer/neo4j-browser/" target="_top">Neo4j Browser</a>.
               </p>
               <p><span class="formalpara-title">The following query exports the whole database to <code class="literal">all-plain.cypher</code>.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.all("all-plain.cypher", {
    format: "plain",
    useOptimizations: {type: "UNWIND_BATCH", unwindBatchSize: 20}
})
YIELD file, batches, source, format, nodes, relationships, properties, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, properties, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15392">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.28.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                        <col class="col_10"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"all-plain.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"database: nodes(8), rels(7)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>8</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>7</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>21</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>9</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>15</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>The contents of <code class="literal">all-plain.cypher</code>, with extra lines added for readability, are shown below:
               </p>
               <p><span class="formalpara-title">all-plain.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;

UNWIND [{_id:0, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Movie;

UNWIND [{_id:1, properties:{born:1964, name:"Keanu Reeves"}}, {_id:2, properties:{born:1967, name:"Carrie-Anne Moss"}}, {_id:3, properties:{born:1961, name:"Laurence Fishburne"}}, {_id:4, properties:{born:1960, name:"Hugo Weaving"}}, {_id:5, properties:{born:1967, name:"Lilly Wachowski"}}, {_id:6, properties:{born:1965, name:"Lana Wachowski"}}, {_id:7, properties:{born:1952, name:"Joel Silver"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Person;

UNWIND [{start: {_id:1}, end: {_id:0}, properties:{roles:["Neo"]}}, {start: {_id:2}, end: {_id:0}, properties:{roles:["Trinity"]}}, {start: {_id:3}, end: {_id:0}, properties:{roles:["Morpheus"]}}, {start: {_id:4}, end: {_id:0}, properties:{roles:["Agent Smith"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ACTED_IN]-&gt;(end) SET r += row.properties;

UNWIND [{start: {_id:7}, end: {_id:0}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:PRODUCED]-&gt;(end) SET r += row.properties;

UNWIND [{start: {_id:5}, end: {_id:0}, properties:{}}, {start: {_id:6}, end: {_id:0}, properties:{}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:DIRECTED]-&gt;(end) SET r += row.properties;

MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;

DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;</code></pre><p>
                  
               </p>
               <p>We can then take the <code class="literal">all-plain.cypher</code> file and drag it onto the Neo4j Browser window.
                  We should then see the following prompt:
               </p>
               <div class="figure" id="d0e15478">
                  <div class="figure-title">Figure&nbsp;6.2.&nbsp;Neo4j Browser prompt when we drag a file onto it</div>
                  <div class="figure-contents">
                     <div class="mediaobject"><img src="../../images/export-cypher-plain-drag.png" alt="export cypher plain drag"></img></div>
                  </div>
               </div>
               <p>And if we click <code class="literal">Paste in editor</code>, the contents of the file will appear in the query editor:
               </p>
               <div class="figure" id="d0e15492">
                  <div class="figure-title">Figure&nbsp;6.3.&nbsp;Neo4j Browser query editor with the contents of <code class="literal">all-plain.cypher</code></div>
                  <div class="figure-contents">
                     <div class="mediaobject"><img src="../../images/export-cypher-plain-editor.png" width="800" alt="export cypher plain editor"></img></div>
                  </div>
               </div>
               <p>We can then press the play button next in the editor and the data will be imported.</p>
            </section>
            <section class="section" id="export-cypher-different-cypher-format">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a class="anchor" href="#export-cypher-different-cypher-format"></a>6.3.5.3.&nbsp;Export using different Cypher update formats
                        </h4>
                     </div>
                  </div>
               </div>
               <p>The export to Cypher procedures generate Cypher statements using the <code class="literal">CREATE</code>, <code class="literal">MATCH</code> and <code class="literal">MERGE</code> clauses.
                  The format is configured by the <code class="literal">cypherFormat</code> parameter.
                  The following values are supported:
               </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem"><code class="literal">create</code> - only uses the <code class="literal">CREATE</code> clause (default)
                     </li>
                     <li class="listitem"><code class="literal">updateAll</code> - uses <code class="literal">MERGE</code> instead of <code class="literal">CREATE</code></li>
                     <li class="listitem"><code class="literal">addStructure</code> - uses <code class="literal">MATCH</code> for nodes and <code class="literal">MERGE</code> for relationships
                     </li>
                     <li class="listitem"><code class="literal">updateStructure</code> - uses <code class="literal">MERGE</code> and <code class="literal">MATCH</code> for nodes and relationships
                     </li>
                  </ul>
               </div>
               <p>If we&#8217;re exporting a database for the first time we should use the default <code class="literal">create</code> format, but for subsequent exports the other formats may be more suitable.
               </p>
               <p><span class="formalpara-title">The following exports the <code class="literal">ACTED_IN</code> relationships and surrounding nodes to <code class="literal">export-cypher-format-create.cypher</code> using the <code class="literal">create</code> format.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">MATCH (person)-[r:ACTED_IN]-&gt;(movie)
WITH collect(DISTINCT person) + collect(DISTINCT  movie) AS importNodes, collect(r) AS importRels
CALL apoc.export.cypher.data(importNodes, importRels,
  "export-cypher-format-create.cypher",
  { format: "plain", cypherFormat: "create" })
YIELD file, batches, source, format, nodes, relationships, properties, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, properties, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15585">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.29.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                        <col class="col_10"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"export-cypher-format-create.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"data: nodes(5), rels(4)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>5</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>15</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>2</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>9</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">export-cypher-format-create.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
UNWIND [{_id:0, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Movie;

UNWIND [{_id:7, properties:{born:1967, name:"Carrie-Anne Moss"}},
        {_id:80, properties:{born:1960, name:"Hugo Weaving"}},
        {_id:27, properties:{born:1964, name:"Keanu Reeves"}},
        {_id:44, properties:{born:1961, name:"Laurence Fishburne"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Person;

UNWIND [{start: {_id:27}, end: {_id:0}, properties:{roles:["Neo"]}},
        {start: {_id:7}, end: {_id:0}, properties:{roles:["Trinity"]}},
        {start: {_id:44}, end: {_id:0}, properties:{roles:["Morpheus"]}},
        {start: {_id:80}, end: {_id:0}, properties:{roles:["Agent Smith"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ACTED_IN]-&gt;(end) SET r += row.properties;

MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;</code></pre><p>
                  
               </p>
               <p>The creation of all graph entities uses the Cypher <code class="literal">CREATE</code> clause.
                  If those entities may already exist in the destination database, we may choose to use another format.
                  Using <code class="literal">cypherFormat: "updateAll"</code> means that the <code class="literal">MERGE</code> clause will be used instead of <code class="literal">CREATE</code> when creating entities.
               </p>
               <p><span class="formalpara-title">The following exports the <code class="literal">ACTED_IN</code> relationships and surrounding nodes to <code class="literal">export-cypher-format-create.cypher</code> using the <code class="literal">updateAll</code> format.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">MATCH (person)-[r:ACTED_IN]-&gt;(movie)
WITH collect(DISTINCT person) + collect(DISTINCT  movie) AS importNodes, collect(r) AS importRels
CALL apoc.export.cypher.data(importNodes, importRels,
  "export-cypher-format-updateAll.cypher",
  { format: "plain", cypherFormat: "updateAll" })
YIELD file, batches, source, format, nodes, relationships, properties, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, properties, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15692">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.30.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                        <col class="col_10"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"export-cypher-format-updateAll.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"data: nodes(5), rels(4)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>5</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>15</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>8</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>9</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">export-cypher-format-updateAll.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
UNWIND [{_id:0, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}] AS row
MERGE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Movie;

UNWIND [{_id:80, properties:{born:1960, name:"Hugo Weaving"}},
        {_id:7, properties:{born:1967, name:"Carrie-Anne Moss"}},
        {_id:44, properties:{born:1961, name:"Laurence Fishburne"}},
        {_id:27, properties:{born:1964, name:"Keanu Reeves"}}] AS row
MERGE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Person;

UNWIND [{start: {_id:27}, end: {_id:0}, properties:{roles:["Neo"]}},
        {start: {_id:7}, end: {_id:0}, properties:{roles:["Trinity"]}},
        {start: {_id:44}, end: {_id:0}, properties:{roles:["Morpheus"]}},
        {start: {_id:80}, end: {_id:0}, properties:{roles:["Agent Smith"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
MERGE (start)-[r:ACTED_IN]-&gt;(end) SET r += row.properties;

MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;</code></pre><p>
                  
               </p>
               <p>If we already have the nodes in our destination database, we can use <code class="literal">cypherFormat: "addStructure"</code> to create Cypher <code class="literal">CREATE</code> statements for just the relationships.
               </p>
               <p><span class="formalpara-title">The following exports the <code class="literal">ACTED_IN</code> relationships and surrounding nodes to <code class="literal">export-cypher-format-addStructure.cypher</code> using the <code class="literal">addStructure</code> format.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">MATCH (person)-[r:ACTED_IN]-&gt;(movie)
WITH collect(DISTINCT person) + collect(DISTINCT  movie) AS importNodes, collect(r) AS importRels
CALL apoc.export.cypher.data(importNodes, importRels,
  "export-cypher-format-addStructure.cypher",
  { format: "plain", cypherFormat: "addStructure" })
YIELD file, batches, source, format, nodes, relationships, properties, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, properties, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15793">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.31.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                        <col class="col_10"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"export-cypher-format-addStructure.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"data: nodes(5), rels(4)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>5</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>15</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>9</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">export-cypher-format-addStructure.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">UNWIND [{_id:0, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}] AS row
MERGE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) ON CREATE SET n += row.properties SET n:Movie;

UNWIND [{_id:7, properties:{born:1967, name:"Carrie-Anne Moss"}},
        {_id:27, properties:{born:1964, name:"Keanu Reeves"}},
        {_id:80, properties:{born:1960, name:"Hugo Weaving"}},
        {_id:44, properties:{born:1961, name:"Laurence Fishburne"}}] AS row
MERGE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) ON CREATE SET n += row.properties SET n:Person;

UNWIND [{start: {_id:27}, end: {_id:0}, properties:{roles:["Neo"]}},
        {start: {_id:7}, end: {_id:0}, properties:{roles:["Trinity"]}},
        {start: {_id:44}, end: {_id:0}, properties:{roles:["Morpheus"]}},
        {start: {_id:80}, end: {_id:0}, properties:{roles:["Agent Smith"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ACTED_IN]-&gt;(end)  SET r += row.properties;</code></pre><p>
                  
               </p>
               <p>In this example we&#8217;re using the <code class="literal">MERGE</code> clause to create a node if it doesn&#8217;t already exist, and are only creating properties if the node doesn&#8217;t already exist.
                  In this example, relationships don&#8217;t exist in the destination database and need to be created.
               </p>
               <p>If those relationships do exist but have properties that need to be updated, we can use <code class="literal">cypherFormat: "updateStructure"</code> to create our import script.
               </p>
               <p><span class="formalpara-title">The following exports the <code class="literal">ACTED_IN</code> relationships and surrounding nodes to <code class="literal">export-cypher-format-updateStructure.cypher</code> using the <code class="literal">updateStructure</code> format.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">MATCH (person)-[r:ACTED_IN]-&gt;(movie)
WITH collect(DISTINCT person) + collect(DISTINCT  movie) AS importNodes, collect(r) AS importRels
CALL apoc.export.cypher.data(importNodes, importRels,
  "export-cypher-format-updateStructure.cypher",
  { format: "plain", cypherFormat: "updateStructure" })
YIELD file, batches, source, format, nodes, relationships, properties, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, properties, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15896">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.32.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                        <col class="col_10"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"export-cypher-format-updateStructure.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"data: nodes(5), rels(4)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>0</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>2</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>4</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">export-cypher-format-updateStructure.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">UNWIND [{start: {_id:27}, end: {_id:0}, properties:{roles:["Neo"]}},
        {start: {_id:7}, end: {_id:0}, properties:{roles:["Trinity"]}},
        {start: {_id:44}, end: {_id:0}, properties:{roles:["Morpheus"]}},
        {start: {_id:80}, end: {_id:0}, properties:{roles:["Agent Smith"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
MERGE (start)-[r:ACTED_IN]-&gt;(end) SET r += row.properties;</code></pre><p>
                  
               </p>
            </section>
            <section class="section" id="export-cypher-multiple-files">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a class="anchor" href="#export-cypher-multiple-files"></a>6.3.5.4.&nbsp;Export to multiple files or columns
                        </h4>
                     </div>
                  </div>
               </div>
               <p>The export to Cypher procedures all support writing to multiple files or multiple columns.
                  We can enable this mode by passing in the config <code class="literal">separateFiles: true</code></p>
               <p><span class="formalpara-title">The following query exports all the <code class="literal">ACTED_IN</code> relationships and corresponding nodes into files with an <code class="literal">actedIn</code> prefix.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.query(
  "MATCH ()-[r:ACTED_IN]-&gt;()
   RETURN *",
  "actedIn.cypher",
  { format: "cypher-shell", separateFiles: true })
YIELD file, batches, source, format, nodes, relationships, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e15993">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.33.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"actedIn.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"statement: nodes(10), rels(8)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>10</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>8</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>3</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>18</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>This will result in the following files being created:</p>
               <div class="table" id="d0e16057">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.34.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">Name</th>
                           <th style="text-align: left; vertical-align: top; ">Size in bytes</th>
                           <th style="text-align: left; vertical-align: top; ">Number of lines</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>actedIn.cleanup.cypher</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>234</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>6</p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>actedIn.nodes.cypher</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>893</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>6</p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>actedIn.relationships.cypher</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>757</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>6</p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>actedIn.schema.cypher</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>109</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>3</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>Each of those files contains one particular part of the graph.
                  Let&#8217;s have a look at their content:
               </p>
               <p><span class="formalpara-title">actedIn.cleanup.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">:begin
MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
:commit
:begin
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
:commit</code></pre><p>
                  
               </p>
               <p><span class="formalpara-title">actedIn.nodes.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">:begin
UNWIND [{_id:28, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}, {_id:37, properties:{tagline:"Welcome to the Real World", title:"The Matrix", released:1999}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Movie;
UNWIND [{_id:31, properties:{born:1961, name:"Laurence Fishburne"}}, {_id:30, properties:{born:1967, name:"Carrie-Anne Moss"}}, {_id:42, properties:{born:1964, name:"Keanu Reeves"}}, {_id:0, properties:{born:1960, name:"Hugo Weaving"}}, {_id:29, properties:{born:1964, name:"Keanu Reeves"}}, {_id:38, properties:{born:1960, name:"Hugo Weaving"}}, {_id:43, properties:{born:1967, name:"Carrie-Anne Moss"}}, {_id:57, properties:{born:1961, name:"Laurence Fishburne"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Person;
:commit</code></pre><p>
                  
               </p>
               <p><span class="formalpara-title">actedIn.relationships.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">:begin
UNWIND [{start: {_id:31}, end: {_id:28}, properties:{roles:["Morpheus"]}}, {start: {_id:42}, end: {_id:37}, properties:{roles:["Neo"]}}, {start: {_id:38}, end: {_id:37}, properties:{roles:["Agent Smith"]}}, {start: {_id:0}, end: {_id:28}, properties:{roles:["Agent Smith"]}}, {start: {_id:29}, end: {_id:28}, properties:{roles:["Neo"]}}, {start: {_id:43}, end: {_id:37}, properties:{roles:["Trinity"]}}, {start: {_id:30}, end: {_id:28}, properties:{roles:["Trinity"]}}, {start: {_id:57}, end: {_id:37}, properties:{roles:["Morpheus"]}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:ACTED_IN]-&gt;(end) SET r += row.properties;
:commit</code></pre><p>
                  
               </p>
               <p><span class="formalpara-title">actedIn.schema.cypher.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">:begin
CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
:commit</code></pre><p>
                  
               </p>
               <p>We can then apply these files to our destination Neo4j instance, either by streaming their contents into Cypher Shell or by
                  using the procedures described in <a class="xref" href="../../cypher-execution/running-cypher/" title="14.1.&nbsp;Running Cypher fragments">Section&nbsp;14.1, &#8220;Running Cypher fragments&#8221;</a></p>
               <p>We can also use the <code class="literal">separateFiles</code> when returning a stream of export statements.
                  The results will appear in columns named <code class="literal">nodeStatements</code>, <code class="literal">relationshipStatements</code>, <code class="literal">cleanupStatements</code>, and <code class="literal">schemaStatements</code> rather than <code class="literal">cypherStatements</code>.
               </p>
               <p><span class="formalpara-title">The following query returns a stream all the <code class="literal">ACTED_IN</code> relationships and corresponding nodes.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.query(
  "MATCH ()-[r:ACTED_IN]-&gt;()
   RETURN *",
  null,
  { format: "cypher-shell", separateFiles: true })
YIELD nodes, relationships, properties, nodeStatements, relationshipStatements, cleanupStatements, schemaStatements
RETURN nodes, relationships, properties, nodeStatements, relationshipStatements, cleanupStatements, schemaStatements;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e16181">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.35.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">properties</th>
                           <th style="text-align: left; vertical-align: top; ">nodeStatements</th>
                           <th style="text-align: left; vertical-align: top; ">relationshipStatements</th>
                           <th style="text-align: left; vertical-align: top; ">cleanupStatements</th>
                           <th style="text-align: left; vertical-align: top; ">schemaStatements</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>10</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>8</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>30</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                   UNWIND [{_id:28, properties:{tagline:\"Welcome to the Real World\", title:\"The Matrix\", released:1999}}, {_id:37, properties:{tagline:\"Welcome
                                 to the Real World\", title:\"The Matrix\", released:1999}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Movie;
                                   UNWIND [{_id:0, properties:{born:1960, name:\"Hugo Weaving\"}}, {_id:42, properties:{born:1964, name:\"Keanu Reeves\"}},
                                 {_id:31, properties:{born:1961, name:\"Laurence Fishburne\"}}, {_id:29, properties:{born:1964, name:\"Keanu Reeves\"}}, {_id:30,
                                 properties:{born:1967, name:\"Carrie-Anne Moss\"}}, {_id:43, properties:{born:1967, name:\"Carrie-Anne Moss\"}}, {_id:38,
                                 properties:{born:1960, name:\"Hugo Weaving\"}}, {_id:57, properties:{born:1961, name:\"Laurence Fishburne\"}}] AS row
                                   CREATE (n:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row._id}) SET n += row.properties SET n:Person;
                                   :commit
                                   "
                              </p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                   UNWIND [{start: {_id:31}, end: {_id:28}, properties:{roles:[\"Morpheus\"]}}, {start: {_id:38}, end: {_id:37}, properties:{roles:[\"Agent
                                 Smith\"]}}, {start: {_id:0}, end: {_id:28}, properties:{roles:[\"Agent Smith\"]}}, {start: {_id:30}, end: {_id:28}, properties:{roles:[\"Trinity\"]}},
                                 {start: {_id:29}, end: {_id:28}, properties:{roles:[\"Neo\"]}}, {start: {_id:43}, end: {_id:37}, properties:{roles:[\"Trinity\"]}},
                                 {start: {_id:42}, end: {_id:37}, properties:{roles:[\"Neo\"]}}, {start: {_id:57}, end: {_id:37}, properties:{roles:[\"Morpheus\"]}}]
                                 AS row
                                   MATCH (start:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.start._id})
                                   MATCH (end:`UNIQUE IMPORT LABEL`{<code class="literal">UNIQUE IMPORT ID</code>: row.end._id})
                                   CREATE (start)-[r:ACTED_IN]&#8594;(end) SET r += row.properties;
                                   :commit
                                   "
                              </p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                   MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.<code class="literal">UNIQUE IMPORT ID</code>;
                                   :commit
                                   :begin
                                   DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.<code class="literal">UNIQUE IMPORT ID</code>) IS UNIQUE;
                                   :commit
                                   "
                              </p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>":begin
                                   CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.<code class="literal">UNIQUE IMPORT ID</code>) IS UNIQUE;
                                   :commit
                                   "
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>We can then copy/paste the content of each of these columns (excluding the double quotes) into a Cypher Shell session, or
                  into a local file that we stream into a Cypher Shell session.
                  If we want to export Cypher statements that can be pasted into the Neo4j Browser query editor, we need to use the config <code class="literal">format: "plain"</code>, as described in <a class="xref" href="#export-cypher-neo4j-browser" title="6.3.5.2.&nbsp;Export to Neo4j Browser friendly format">Section&nbsp;6.3.5.2, &#8220;Export to Neo4j Browser friendly format&#8221;</a>.
               </p>
            </section>
            <section class="section" id="export-cypher-examples-roundtrip">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a class="anchor" href="#export-cypher-examples-roundtrip"></a>6.3.5.5.&nbsp;Round trip
                        </h4>
                     </div>
                  </div>
               </div>
               <p>This example shows how to export data from one Neo4j instance (the source database) and import it into another one (the destination
                  database).
               </p>
               <p><span class="formalpara-title">The following exports 100 nodes and relationships from the source database in <code class="literal">plain</code> format into multiple files.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.export.cypher.query(
    "match (n)-[r]-&gt;(n2) return * limit 100",
    "/tmp/mysubset.cypher",
    {format:'plain',separateFiles:true}
)
YIELD file, batches, source, format, nodes, relationships, time, rows, batchSize
RETURN file, batches, source, format, nodes, relationships, time, rows, batchSize;</code></pre><p>
                  
               </p>
               <div class="table" id="d0e16275">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.36.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                        <col class="col_3"></col>
                        <col class="col_4"></col>
                        <col class="col_5"></col>
                        <col class="col_6"></col>
                        <col class="col_7"></col>
                        <col class="col_8"></col>
                        <col class="col_9"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">file</th>
                           <th style="text-align: left; vertical-align: top; ">batches</th>
                           <th style="text-align: left; vertical-align: top; ">source</th>
                           <th style="text-align: left; vertical-align: top; ">format</th>
                           <th style="text-align: left; vertical-align: top; ">nodes</th>
                           <th style="text-align: left; vertical-align: top; ">relationships</th>
                           <th style="text-align: left; vertical-align: top; ">time</th>
                           <th style="text-align: left; vertical-align: top; ">rows</th>
                           <th style="text-align: left; vertical-align: top; ">batchSize</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"/tmp/mysubset.cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"statement: nodes(16), rels(14)"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>"cypher"</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>16</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>14</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>9</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>30</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>20000</p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>This should result in 4 files in your directory.</p><pre class="programlisting highlight"><code data-lang="shell">ls -1 /tmp/mysubset.*
/tmp/mysubset.cleanup.cypher
/tmp/mysubset.nodes.cypher
/tmp/mysubset.relationships.cypher
/tmp/mysubset.schema.cypher</code></pre><p>Now let&#8217;s copy those files so they&#8217;re accessible from our destination database.
                  We&#8217;ll need to first add the following property to <code class="literal">apoc.conf</code>:
               </p>
               <p><span class="formalpara-title">apoc.conf.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="properties">apoc.import.file.enabled=true</code></pre><p>
                  
               </p>
               <p>And now we&#8217;re going to use procedures from <a class="xref" href="../../cypher-execution/running-cypher/" title="14.1.&nbsp;Running Cypher fragments">Section&nbsp;14.1, &#8220;Running Cypher fragments&#8221;</a> to import the data.
               </p>
               <p><span class="formalpara-title">The following imports the schema.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.cypher.runSchemaFile('/tmp/mysubset.schema.cypher');</code></pre><p>
                  
               </p>
               <div class="table" id="d0e16366">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.37.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">row</th>
                           <th style="text-align: left; vertical-align: top; ">result</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 0, rows: 0, propertiesSet: 0, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 0, r
                                    elationshipsCreated: 0, time: 0}
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">The following imports the nodes and relationships.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.cypher.runFiles(['/tmp/mysubset.nodes.cypher','/tmp/mysubset.relationships.cypher']);</code></pre><p>
                  
               </p>
               <div class="table" id="d0e16394">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.38.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">row</th>
                           <th style="text-align: left; vertical-align: top; ">result</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 2, rows: 0, propertiesSet: 8, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 4, r
                                 elationshipsCreated: 0, time: 0}
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 14, rows: 0, propertiesSet: 42, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 28
                                 , relationshipsCreated: 0, time: 0}
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 0, rows: 0, propertiesSet: 8, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 0, r
                                 elationshipsCreated: 8, time: 0}
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 0, rows: 0, propertiesSet: 0, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 0, r
                                 elationshipsCreated: 2, time: 0}
                              </p>
                           </td>
                        </tr>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 0, rows: 0, propertiesSet: 0, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 0, r
                                 elationshipsCreated: 4, time: 0}
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">The following removes temporary node labels and properties.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.cypher.runFile('/tmp/mysubset.cleanup.cypher');</code></pre><p>
                  
               </p>
               <div class="table" id="d0e16450">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.39.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">row</th>
                           <th style="text-align: left; vertical-align: top; ">result</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 0, indexesRemoved: 0, nodesCreated: 0, rows: 0, propertiesSet: 16, labelsRemoved: 16, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 0,
                                     relationshipsCreated: 0, time: 0}
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p><span class="formalpara-title">The following drops the import specific constraint.&nbsp;</span>
                  
               </p><pre class="programlisting highlight"><code data-lang="cypher">CALL apoc.cypher.runSchemaFile('/tmp/mysubset.cleanup.cypher');</code></pre><p>
                  
               </p>
               <div class="table" id="d0e16478">
                  <table class="table" summary="Results" border="1">
                     <caption class="table-title">Table&nbsp;6.40.&nbsp;Results</caption>
                     <colgroup>
                        <col class="col_1"></col>
                        <col class="col_2"></col>
                     </colgroup>
                     <thead>
                        <tr>
                           <th style="text-align: left; vertical-align: top; ">row</th>
                           <th style="text-align: left; vertical-align: top; ">result</th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>-1</p>
                           </td>
                           <td style="text-align: left; vertical-align: top; ">
                              <p>{constraintsRemoved: 1, indexesRemoved: 0, nodesCreated: 0, rows: 0, propertiesSet: 0, labelsRemoved: 0, relationshipsDeleted:
                                 0, constraintsAdded: 0, nodesDeleted: 0, indexesAdded: 0, labelsAdded: 0, r
                                    elationshipsCreated: 0, time: 0}
                              </p>
                           </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
               <p>The <code class="literal">apoc.cypher.run*</code> procedures have some optional config:
               </p>
               <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                     <li class="listitem"><code class="literal">{statistics:true/false}</code> to output a row of update-stats per statement, default is true
                     </li>
                     <li class="listitem"><code class="literal">{timeout:1 or 10}</code> for how long the stream waits for new data, default is 10
                     </li>
                  </ul>
               </div>
               <p>Make sure to set the config options in your <code class="literal">neo4j.conf</code></p>
            </section>
         </section>
      </section>
      <footer><script type="text/javascript">
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          //Allow Linker
          ga('create', 'UA-1192232-34','auto', {'allowLinker': true});
          ga('send', 'pageview');
          // Load the plugin.
          ga('require', 'linker');
          // Define which domains to autoLink.
          ga('linker:autoLink', ['neo4j.org','neo4j.com','neotechnology.com','graphdatabases.com','graphconnect.com']);
        </script><script type="text/javascript">
          (function() {
          var didInit = false;
          function initMunchkin() {
            if(didInit === false) {
              didInit = true;
              Munchkin.init('710-RRC-335');
            }
          }
          var s = document.createElement('script');
          s.type = 'text/javascript';
          s.async = true;
          s.src = '//munchkin.marketo.net/munchkin.js';
          s.onreadystatechange = function() {
            if (this.readyState == 'complete' || this.readyState == 'loaded') {
              initMunchkin();
            }
          };
          s.onload = initMunchkin;
          document.getElementsByTagName('head')[0].appendChild(s);
          })();
        </script></footer>
   </body>
</html>